# Resident（居民）的设定

Resident就是这个世界的角色，包括人类、中立生物、反派生物等。

每一个居民都由下列重要部分组成：

1. 大脑（Brain）：即以LLM为核心的部分。所有居民的思考、沟通等，都需要以LLM的能力作为核心驱动力。同类别的居民所使用的LLM是一样的。
2. 记忆（Memory）：记忆以带有权重的流体存在，形成记忆流（Memory Stream）。
3. 概念（Concept）：概念代表的是灵魂，是一个特定的居民区别于其他居民最重要的原因。
4. 躯体（Physical Body）：代表居民的身份、职业、外貌、年龄等。该设定是自上而下的设定，即由开发者来决定，居民无法自行更改。
5. 行动周期（Physical Cycle）：代表该居民的行为方式，比如活动时间、睡觉时间、做梦时间等。
6. 居民知识（Resident's Knowledge）：由世界知识和个人知识组成。世界知识是所有居民都熟悉的常识，而个人知识则包括特定的历史、文化和职业知识等。
7. 能力（Ability）：提供用于执行任务的程序性技能。

上面的记忆、概念和知识系统共同塑造一个特有的个体。

## 大脑

在V1版本中，所有的居民都是用同样的LLM。

注：后续可能会考虑对不同生物、不同职业采用不同的LLM。比如说，对于中立生物，采用较为简单的LLM模型，因为他们的理解能力非常低。甚至对于一些动物来说，直接采用硬编码程序，让这些动物不具备任何的思考能力。而在人类中，对于祭司等掌权者，可能会考虑用更高阶的LLM，而对于普通人来说，可能就是用比较初阶的LLM。

值得注意的是，在理想的设定中，每一个居民的大脑本身就是一个神经网络，而每个居民的神经网络是会因为交互、环境等发生变化的。但是由于现在的技术无法支持可变神经网络或持续学习（continuing learning），因此只能退而求其次，采用概念和记忆的方式，配合LLM，来对人的思维进行抽象。

## 记忆 Memory

记忆是一个非常重要的内容。这里采用人类的设定，每个居民都具有短期记忆和长期记忆。

短期记忆很简单，就是当天发生的事件全部都会被记录在记忆流中。这些事件包括但不限于：

* Observation，观察
* Dialogues
* Thoughts
* Actions
* Reflections
* Plans&Goals

长期记忆和短期记忆存储在两个数据库中。短期记忆在每天晚上睡觉的时候，会在做梦中被整理、处理为长期记忆，整理总结在长期记忆流中。而短期记忆流在做梦中并不会改变，只是会被第二天及后续发生的事情所带来的新的事件逐步覆盖，做梦的时候未被收集压缩的信息，在被覆盖后就算是被“遗忘”了。

短期记忆流是一个顺序数据库，在提取短期记忆的时候只会提取倒序的大小为K的窗口内的记忆。因此，被遗忘的短期记忆依然会被存储在短期记忆流中，只是程序无法访问到，即居民无法通过自身的能力来唤醒记忆。

## 概念

概念是显著区别于一个居民和另一个居民最为重要的部分，也是居民的灵魂所在。概念由三个核心概念组成：

1. Ego（自我）：The idea of who am I, where am I.
2. Goal（目标）：The idea of dream, ideal partner, etc. 这里体现的主要是长期目标，比如理想、梦想、人生追求等。
3. Memory Abstraction（记忆抽象）：对过去记忆的理解。

暂时考虑概念以树状的数据结构组成。

## 躯体

躯体（Physical Body）：代表居民的身份、职业、外貌、年龄等。该设定是自上而下的设定，即由开发者来决定，居民无法自行更改。

## 行动周期

行动周期（Physical Cycle）：代表该居民的行为方式，比如活动时间、睡觉时间、做梦时间等。

## 居民知识（详见世界设定中的知识系统）

知识系统（Knowledge System）：由世界知识和个人知识组成。世界知识是所有居民共同遵守的，而个人知识则包括职业知识比如如何打铁等。

知识系统部分属于个人领域，部分属于世界领域。

个人领域的知识主要体现在技能与专业知识上。通过技能修炼和专业知识学习，居民可以提升自己的技能等级，从而获得更多的技能点数。

知识系统和躯体设定中的职业高度绑定。比如说，铁匠职业者只能习得铁匠技能和知识，而无法习得魔法专业知识。

每个居民都会有一个独属于自己的知识系统，每个居民自己的知识系统都是世界知识系统的子集。

## 能力

能力系统主要决定职业发展等。对于每个人而言，能力只能点一个技能树中的能力。

能力以树状方式存储，在V1版本中：

1. 第一层是根能力，也就是每个居民都会的能力，比如移动、交互、寻路等。
2. 第二层是躯体能力，比如男性人类、女性人类、中立生物、雄性恶魔等独属的能力。
3. 第三层是职业能力，比如牧师、铁匠、剑士等。

V1版本中暂时设置这么三层就够了。
